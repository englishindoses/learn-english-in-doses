<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Track your English grammar learning progress - Advanced ESL Grammar">
  <title>My Progress - Advanced ESL Grammar</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&family=Source+Code+Pro&display=swap" rel="stylesheet">
  
  <!-- Styles -->
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/activities.css">

  <style>
    /* Additional styles specific to progress page */
    .progress-card {
      background-color: var(--card-bg);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px var(--shadow-color);
      border-left: 5px solid var(--accent-color);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .stat-card {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 4px var(--shadow-color);
      transition: transform 0.3s;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
    }
    
    .stat-number {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--accent-color);
      margin: 10px 0;
      font-family: 'Montserrat', sans-serif;
    }
    
    .stat-label {
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
    }
    
    .streak-card {
      border-left: 5px solid #f07d3e;
    }
    
    .streak-number {
      color: #f07d3e;
    }
    
    .progress-section-title {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .progress-section-title h2 {
      margin: 0;
      border-bottom: none;
    }
    
    .view-all-link {
      margin-left: auto;
      font-size: 0.9rem;
    }

    /* Progress bars */
    .category-progress {
      margin-bottom: 15px;
    }
    
    .category-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
    }
    
    .category-name {
      font-weight: 600;
    }
    
    .category-percentage {
      font-weight: 600;
    }
    
    .progress-outer {
      height: 12px;
      background-color: var(--progress-bg);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 5px;
    }
    
    .progress-inner {
      height: 100%;
      background-color: var(--progress-fill);
      border-radius: 10px;
      transition: width 1s ease;
    }
    
    /* Achievements */
    .achievements-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    .achievement-card {
      background-color: var(--card-bg);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 2px 4px var(--shadow-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.3s;
    }
    
    .achievement-card:hover {
      transform: translateY(-5px);
    }
    
    .achievement-icon {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    .achievement-title {
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .achievement-description {
      font-size: 0.85rem;
      color: var(--text-color);
      opacity: 0.8;
    }
    
    .locked-achievement {
      opacity: 0.5;
      filter: grayscale(1);
    }
    
    .locked-achievement::after {
      content: "üîí";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      opacity: 0.8;
    }
    
    /* Recent Activity */
    .activity-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      box-shadow: 0 1px 3px var(--shadow-color);
      transition: transform 0.2s;
    }
    
    .activity-item:hover {
      transform: translateX(5px);
    }
    
    .activity-icon {
      font-size: 1.5rem;
      margin-right: 15px;
      min-width: 30px;
      text-align: center;
    }
    
    .activity-details {
      flex-grow: 1;
    }
    
    .activity-title {
      display: block;
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .activity-meta {
      display: flex;
      font-size: 0.8rem;
      color: var(--text-color);
      opacity: 0.7;
    }
    
    .activity-score {
      margin-right: 15px;
    }
    
    /* Recommendation Section */
    .recommendation-card {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      background-color: var(--card-bg);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 4px var(--shadow-color);
      border-left: 5px solid var(--accent-color);
      transition: transform 0.3s;
    }
    
    .recommendation-card:hover {
      transform: translateY(-5px);
    }
    
    .recommendation-title {
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .recommendation-description {
      margin-bottom: 15px;
      font-size: 0.9rem;
    }
    
    .recommendation-button {
      background-color: var(--accent-color);
      color: white;
      padding: 8px 15px;
      border-radius: 4px;
      text-decoration: none;
      align-self: flex-end;
      transition: background-color 0.3s, transform 0.2s;
    }
    
    .recommendation-button:hover {
      background-color: #2980b9;
      transform: translateY(-2px);
      text-decoration: none;
    }
    
    /* Reset button */
    .danger-zone {
      border-left: 5px solid var(--error-color);
      margin-top: 30px;
    }
    
    .reset-button {
      background-color: var(--error-color);
      color: white;
      padding: 10px 15px;
      border-radius: 4px;
      margin-top: 10px;
      cursor: pointer;
      border: none;
      transition: background-color 0.3s;
    }
    
    .reset-button:hover {
      background-color: #bd2130;
    }
    
    .confirm-reset {
      display: none;
      background-color: var(--error-bg);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    /* No progress message */
    .no-progress-message {
      text-align: center;
      padding: 40px 20px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin: 30px 0;
    }
    
    .no-progress-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.7;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .achievements-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 480px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .achievements-container {
        grid-template-columns: 1fr;
      }
      
      .stat-number {
        font-size: 2rem;
      }
      
      .activity-meta {
        flex-direction: column;
      }
      
      .activity-score {
        margin-right: 0;
        margin-bottom: 5px;
      }
    }
  </style>
</head>
<body>
  <!-- Skip link for accessibility -->
  <a href="#main-content" class="skip-link">Skip to content</a>
  
  <!-- Theme toggle button -->
  <div class="theme-toggle-container">
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
      <span class="light-icon">‚òÄÔ∏è</span>
      <span class="dark-icon">üåô</span>
    </button>
  </div>
  
  <!-- Main navigation -->
  <nav class="main-navigation">
    <a href="index.html" class="site-logo">ESL Grammar</a>
    <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
    <div class="nav-links">
      <a href="index.html" class="nav-link">Home</a>
      <a href="grammar.html" class="nav-link">Grammar</a>
      <a href="extra-practice.html" class="nav-link">Extra Practice</a>
      <a href="progress.html" class="nav-link active">My Progress</a>
    </div>
  </nav>

  <div class="container">
    <!-- Breadcrumbs -->
    <div class="breadcrumbs" aria-label="breadcrumb">
      <span class="breadcrumb-item"><a href="index.html">Home</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item">My Progress</span>
    </div>

    <main id="main-content">
      <h1>My Progress</h1>
      
      <!-- No progress message (initially hidden) -->
      <div id="no-progress-message" class="no-progress-message" style="display: none;">
        <div class="no-progress-icon">üìä</div>
        <h2>No progress yet</h2>
        <p>You haven't completed any activities yet. Start learning to track your progress!</p>
        <a href="home.html#where-to-start" class="primary-button">Start Learning</a>
      </div>
      
      <!-- Progress content (initially hidden) -->
      <div id="progress-content">
        <!-- Summary Stats -->
        <section class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Overall Progress</div>
            <div id="overall-percentage" class="stat-number">0%</div>
            <div id="overall-fraction" class="stat-label">0/0 completed</div>
          </div>
          
          <div class="stat-card">
            <div class="stat-label">Activities Completed</div>
            <div id="activities-count" class="stat-number">0</div>
            <div class="stat-label">out of <span id="total-activities">0</span></div>
          </div>
          
          <div class="stat-card">
            <div class="stat-label">Lessons Completed</div>
            <div id="lessons-count" class="stat-number">0</div>
            <div class="stat-label">out of <span id="total-lessons">0</span></div>
          </div>
          
          <div class="stat-card streak-card">
            <div class="stat-label">Current Streak</div>
            <div id="streak-count" class="stat-number streak-number">0</div>
            <div class="stat-label">consecutive days</div>
          </div>
        </section>
        
        <!-- Progress Overview -->
        <section class="progress-card">
          <div class="progress-section-title">
            <h2>Progress by Category</h2>
          </div>
          
          <div id="category-progress-container">
            <!-- Overall Progress Bar -->
            <div class="category-progress">
              <div class="category-header">
                <span class="category-name">Overall</span>
                <span id="overall-percent" class="category-percentage">0%</span>
              </div>
              <div class="progress-outer">
                <div id="overall-progress-bar" class="progress-inner" style="width: 0%"></div>
              </div>
            </div>
            
            <!-- Activities Progress Bar -->
            <div class="category-progress">
              <div class="category-header">
                <span class="category-name">Activities</span>
                <span id="activities-percent" class="category-percentage">0%</span>
              </div>
              <div class="progress-outer">
                <div id="activities-progress-bar" class="progress-inner" style="width: 0%"></div>
              </div>
            </div>
            
            <!-- Lessons Progress Bar -->
            <div class="category-progress">
              <div class="category-header">
                <span class="category-name">Lessons</span>
                <span id="lessons-percent" class="category-percentage">0%</span>
              </div>
              <div class="progress-outer">
                <div id="lessons-progress-bar" class="progress-inner" style="width: 0%"></div>
              </div>
            </div>
            
            <!-- Assessments Progress Bar -->
            <div class="category-progress">
              <div class="category-header">
                <span class="category-name">Assessments</span>
                <span id="assessments-percent" class="category-percentage">0%</span>
              </div>
              <div class="progress-outer">
                <div id="assessments-progress-bar" class="progress-inner" style="width: 0%"></div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- Recent Activity -->
        <section class="progress-card">
          <div class="progress-section-title">
            <h2>Recent Activity</h2>
          </div>
          
          <ul id="recent-activity-list" class="activity-list">
            <!-- Activity items will be populated by JavaScript -->
          </ul>
        </section>
        
        <!-- Achievements -->
        <section class="progress-card">
          <div class="progress-section-title">
            <h2>Achievements</h2>
          </div>
          
          <div id="achievements-container" class="achievements-container">
            <!-- Achievements will be populated by JavaScript -->
          </div>
        </section>
        
        <!-- Recommendations -->
        <section class="progress-card">
          <div class="progress-section-title">
            <h2>Recommended Next Steps</h2>
          </div>
          
          <div id="recommendations-container">
            <!-- Recommendations will be populated by JavaScript -->
          </div>
        </section>
        
        <!-- Reset Progress (Danger Zone) -->
        <section class="progress-card danger-zone">
          <h2>Reset Progress</h2>
          <p>If you want to start fresh, you can reset all your progress data. <strong>Warning: This action cannot be undone.</strong></p>
          
          <button id="show-reset-confirm" class="reset-button">Reset My Progress</button>
          
          <div id="confirm-reset" class="confirm-reset">
            <p>Are you sure you want to reset all your progress? All your activity data, achievements, and statistics will be permanently deleted.</p>
            <div class="control-buttons">
              <button id="cancel-reset" class="submit-btn">Cancel</button>
              <button id="confirm-reset-button" class="reset-button">Yes, Reset Everything</button>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>
  
  <!-- Include footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="grammar.html">Grammar</a></li>
          <li><a href="extra-practice.html">Extra Practice</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Grammar Topics</h3>
        <ul>
          <li><a href="tenses.html">Advanced Tenses</a></li>
          <li><a href="conditionals.html">Conditionals</a></li>
          <li><a href="modals.html">Modal Verbs</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Connect</h3>
        <ul>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>¬© 2025 English in Doses | All rights reserved</p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="js/core.js"></script>
  <script src="js/progress-tracking.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Check if progress tracking module is available
      if (typeof ProgressTrackingModule === 'undefined') {
        console.error('Progress tracking module not loaded');
        return;
      }
      
      // Initialize progress tracking
      ProgressTrackingModule.init({
        categories: {
          activities: {
            grammarActivities: [
              'mcq', 'gap-fill', 'matching', 'transformation',
              'drag-drop', 'error-correction', 'situations'
            ],
            practiceActivities: [
              'tenses-practice', 'conditionals-practice', 'modals-practice',
              'passive-practice', 'articles-practice', 'prepositions-practice'
            ]
          },
          lessons: {
            grammarLessons: [
              'tenses', 'conditionals', 'modals', 'passive', 
              'articles', 'prepositions', 'clauses'
            ],
            specialTopics: [
              'academic-writing', 'business-english', 'pronunciation'
            ]
          },
          assessments: {
            grammarTests: [
              'tenses-test', 'conditionals-test', 'modals-test',
              'passive-test', 'articles-test', 'prepositions-test'
            ],
            comprehensiveTests: [
              'mid-course-test', 'final-test'
            ]
          }
        },
        onProgressChange: updateProgressDisplay
      });
      
      // Get progress data
      const progress = ProgressTrackingModule.getOverallProgress();
      
      // Check if there's any progress data
      if (progress.completed === 0) {
        // Show no progress message
        document.getElementById('no-progress-message').style.display = 'block';
        document.getElementById('progress-content').style.display = 'none';
      } else {
        // Show progress content
        document.getElementById('no-progress-message').style.display = 'none';
        document.getElementById('progress-content').style.display = 'block';
        
        // Update progress display
        updateProgressDisplay();
      }
      
      // Set up reset button handler
      document.getElementById('show-reset-confirm').addEventListener('click', function() {
        document.getElementById('confirm-reset').style.display = 'block';
        this.style.display = 'none';
      });
      
      document.getElementById('cancel-reset').addEventListener('click', function() {
        document.getElementById('confirm-reset').style.display = 'none';
        document.getElementById('show-reset-confirm').style.display = 'block';
      });
      
      document.getElementById('confirm-reset-button').addEventListener('click', function() {
        // Reset progress
        ProgressTrackingModule.resetAllProgress(false); // Don't show browser confirm dialogue
        
        // Show success message
        showFeedbackMessage('All progress has been reset.', 'info', 3000);
        
        // Reload the page after a short delay
        setTimeout(function() {
          window.location.reload();
        }, 1500);
      });
    });
    
    /**
     * Updates the progress display based on current progress data
     */
    function updateProgressDisplay() {
      const progress = ProgressTrackingModule.getOverallProgress();
      
      // Update summary stats
      document.getElementById('overall-percentage').textContent = progress.percentage + '%';
      document.getElementById('overall-fraction').textContent = `${progress.completed}/${progress.total} completed`;
      
      document.getElementById('activities-count').textContent = progress.categories.activities.completed;
      document.getElementById('total-activities').textContent = progress.categories.activities.total;
      
      document.getElementById('lessons-count').textContent = progress.categories.lessons.completed;
      document.getElementById('total-lessons').textContent = progress.categories.lessons.total;
      
      // Get streak from progress data (if available)
      const stats = ProgressTrackingModule.getStats ? ProgressTrackingModule.getStats() : { dailyStreak: 0 };
      document.getElementById('streak-count').textContent = stats.dailyStreak || 0;
      
      // Update progress bars
      document.getElementById('overall-percent').textContent = progress.percentage + '%';
      document.getElementById('overall-progress-bar').style.width = progress.percentage + '%';
      
      document.getElementById('activities-percent').textContent = progress.categories.activities.percentage + '%';
      document.getElementById('activities-progress-bar').style.width = progress.categories.activities.percentage + '%';
      
      document.getElementById('lessons-percent').textContent = progress.categories.lessons.percentage + '%';
      document.getElementById('lessons-progress-bar').style.width = progress.categories.lessons.percentage + '%';
      
      document.getElementById('assessments-percent').textContent = progress.categories.assessments.percentage + '%';
      document.getElementById('assessments-progress-bar').style.width = progress.categories.assessments.percentage + '%';
      
      // Update recent activity
      updateRecentActivity();
      
      // Update achievements
      updateAchievements();
      
      // Update recommendations
      updateRecommendations();
    }
    
    /**
     * Updates the recent activity list
     */
    function updateRecentActivity() {
      const activityContainer = document.getElementById('recent-activity-list');
      
      // Clear existing content
      activityContainer.innerHTML = '';
      
      // Get recent activity (using a helper function since this is normally on the module)
      const recentActivity = getRecentActivity(5);
      
      if (recentActivity.length === 0) {
        activityContainer.innerHTML = '<p>No recent activity to display.</p>';
        return;
      }
      
      // Add each activity to the list
      recentActivity.forEach(activity => {
        const item = document.createElement('li');
        item.className = 'activity-item';
        
        // Determine icon based on activity type
        let icon = 'üìù';
        if (activity.category === 'lessons') {
          icon = 'üìö';
        } else if (activity.category === 'assessments') {
          icon = 'üìä';
        }
        
        item.innerHTML = `
          <span class="activity-icon">${icon}</span>
          <div class="activity-details">
            <span class="activity-title">${activity.title}</span>
            <div class="activity-meta">
              ${activity.score ? `<span class="activity-score">Score: ${activity.score}/${activity.maxScore}</span>` : ''}
              <span class="activity-date">${formatRelativeTime(activity.completedAt)}</span>
            </div>
          </div>
        `;
        
        activityContainer.appendChild(item);
      });
    }
    
    /**
     * Updates the achievements display
     */
    function updateAchievements() {
      const achievementsContainer = document.getElementById('achievements-container');
      
      // Clear existing content
      achievementsContainer.innerHTML = '';
      
      // Get unlocked achievements
      const achievements = ProgressTrackingModule.getUnlockedAchievements ? ProgressTrackingModule.getUnlockedAchievements() : [];
      
      // Define some default achievements to show (in case no real ones exist yet)
      const defaultAchievements = [
        {
          id: 'first_activity',
          title: 'First Steps',
          description: 'Complete your first activity',
          icon: 'üèÜ',
          unlocked: achievements.some(a => a.id === 'first_activity')
        },
        {
          id: 'five_activities',
          title: 'Getting Started',
          description: 'Complete 5 activities',
          icon: 'üî•',
          unlocked: achievements.some(a => a.id === 'five_activities')
        },
        {
          id: 'ten_activities',
          title: 'Making Progress',
          description: 'Complete 10 activities',
          icon: '‚≠ê',
          unlocked: achievements.some(a => a.id === 'ten_activities')
        },
        {
          id: 'perfect_score',
          title: 'Perfect!',
          description: 'Get a perfect score on any activity',
          icon: 'üíØ',
          unlocked: achievements.some(a => a.id === 'perfect_score')
        },
        {
          id: 'daily_streak_3',
          title: 'Consistency',
          description: 'Study for 3 days in a row',
          icon: 'üìÖ',
          unlocked: achievements.some(a => a.id === 'daily_streak_3')
        },
        {
          id: 'category_complete',
          title: 'Master of Grammar',
          description: 'Complete all activities in a grammar category',
          icon: 'üéì',
          unlocked: achievements.some(a => a.id === 'category_complete')
        }
      ];
      
      // Add each achievement
      defaultAchievements.forEach(achievement => {
        const card = document.createElement('div');
        card.className = `achievement-card ${achievement.unlocked ? '' : 'locked-achievement'}`;
        
        card.innerHTML = `
          <div class="achievement-icon">${achievement.icon}</div>
          <div class="achievement-title">${achievement.title}</div>
          <div class="achievement-description">${achievement.description}</div>
        `;
        
        achievementsContainer.appendChild(card);
      });
    }
    
    /**
     * Updates the recommendations section
     */
    function updateRecommendations() {
      const recommendationsContainer = document.getElementById('recommendations-container');
      
      // Clear existing content
      recommendationsContainer.innerHTML = '';
      
      // Generate recommendations based on progress
      const recommendations = generateRecommendations();
      
      if (recommendations.length === 0) {
        recommendationsContainer.innerHTML = '<p>Congratulations! You have completed all available content.</p>';
        return;
      }
      
      // Show up to 3 recommendations
      recommendations.slice(0, 3).forEach(recommendation => {
        const card = document.createElement('div');
        card.className = 'recommendation-card';
        
        card.innerHTML = `
          <div class="recommendation-title">${recommendation.title}</div>
          <div class="recommendation-description">${recommendation.description}</div>
          <a href="${recommendation.url}" class="recommendation-button">Continue</a>
        `;
        
        recommendationsContainer.appendChild(card);
      });
    }
    
    /**
     * Helper function to generate recommendations based on progress
     * This would normally use actual data from ProgressTrackingModule
     */
    function generateRecommendations() {
      const recommendations = [];
      
      // Get incomplete activities and lessons from ProgressTrackingModule
      const incompleteActivities = getIncompleteItems('activities');
      const incompleteLessons = getIncompleteItems('lessons');
      
      // Add recommendations based on incomplete items
      if (incompleteLessons.length > 0) {
        recommendations.push({
          title: 'Continue with ' + incompleteLessons[0].title,
          description: 'You\'ve started this lesson but haven\'t completed it yet.',
          url: incompleteLessons[0].url
        });
      }
      
      if (incompleteActivities.length > 0) {
        recommendations.push({
          title: 'Practice with ' + incompleteActivities[0].title,
          description: 'Complete this activity to reinforce your grammar skills.',
          url: incompleteActivities[0].url
        });
      }
      
      // Add a recommendation for next logical topic
      recommendations.push({
        title: 'Explore Modal Verbs',
        description: 'Based on your progress, this would be a good topic to study next.',
        url: 'modals.html'
      });
      
      return recommendations;
    }
    
    /**
     * Helper function to get incomplete items from a category
     * This would normally come from ProgressTrackingModule
     */
    function getIncompleteItems(category) {
      // This is a mock implementation - in real use, this would query ProgressTrackingModule
      
      if (category === 'activities') {
        return [
          { id: 'conditionals-practice', title: 'Conditionals Practice', url: 'conditionals-practice.html' },
          { id: 'modals-practice', title: 'Modal Verbs Practice', url: 'modals-practice.html' }
        ];
      } else if (category === 'lessons') {
        return [
          { id: 'modals', title: 'Modal Verbs', url: 'modals.html' },
          { id: 'passive', title: 'Passive Voice', url: 'passive.html' }
        ];
      }
      
      return [];
    }
    
    /**
     * Helper function to get recent activity
     * This would normally come from ProgressTrackingModule
     */
    function getRecentActivity(limit = 5) {
      // This is a mock implementation - in real use, this would query ProgressTrackingModule
      
      const now = new Date();
      const yesterday = new Date(now);
      yesterday.setDate(yesterday.getDate() - 1);
      
      const twoDaysAgo = new Date(now);
      twoDaysAgo.setDate(twoDaysAgo.getDate() - 2);
      
      return [
        {
          id: 'mcq-tenses',
          category: 'activities',
          title: 'Present Perfect Practice',
          score: 8,
          maxScore: 10,
          completedAt: now.toISOString()
        },
        {
          id: 'tenses',
          category: 'lessons',
          title: 'Advanced Tenses',
          completedAt: yesterday.toISOString()
        },
        {
          id: 'gap-fill-tenses',
          category: 'activities',
          title: 'Tenses Gap Fill',
          score: 7,
          maxScore: 10,
          completedAt: yesterday.toISOString()
        },
        {
          id: 'matching-conditionals',
          category: 'activities',
          title: 'Conditionals Matching Exercise',
          score: 5,
          maxScore: 5,
          completedAt: twoDaysAgo.toISOString()
        }
      ].slice(0, limit);
    }
    
    /**
     * Helper function to format relative time
     */
    function formatRelativeTime(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      
      const diffInSeconds = Math.floor((now - date) / 1000);
      
      if (diffInSeconds < 60) {
        return 'Just now';
      }
      
      const diffInMinutes = Math.floor(diffInSeconds / 60);
      if (diffInMinutes < 60) {
        return `${diffInMinutes} minute${diffInMinutes !== 1 ? 's' : ''} ago`;
      }
      
      const diffInHours = Math.floor(diffInMinutes / 60);
      if (diffInHours < 24) {
        return `${diffInHours} hour${diffInHours !== 1 ? 's' : ''} ago`;
      }
      
      const diffInDays = Math.floor(diffInHours / 24);
      if (diffInDays < 7) {
        if (diffInDays === 0) return 'Today';
        if (diffInDays === 1) return 'Yesterday';
        return `${diffInDays} days ago`;
      }
      
      const diffInWeeks = Math.floor(diffInDays / 7);
      if (diffInWeeks < 4) {
        return `${diffInWeeks} week${diffInWeeks !== 1 ? 's' : ''} ago`;
      }
      
      const diffInMonths = Math.floor(diffInDays / 30);
      if (diffInMonths < 12) {
        return `${diffInMonths} month${diffInMonths !== 1 ? 's' : ''} ago`;
      }
      
      const diffInYears = Math.floor(diffInDays / 365);
      return `${diffInYears} year${diffInYears !== 1 ? 's' : ''} ago`;
    }
    
    /**
     * Helper function to show feedback messages
     */
    function showFeedbackMessage(message, type = 'info', duration = 3000) {
      // Check if feedback container exists
      let container = document.getElementById('feedback-container');
      
      // Create container if it doesn't exist
      if (!container) {
        container = document.createElement('div');
        container.id = 'feedback-container';
        container.style.position = 'fixed';
        container.style.top = '20px';
        container.style.right = '20px';
        container.style.zIndex = '9999';
        document.body.appendChild(container);
      }
      
      // Create message element
      const messageElement = document.createElement('div');
      messageElement.className = `feedback-message feedback-${type}`;
      messageElement.textContent = message;
      messageElement.style.backgroundColor = type === 'info' ? '#3498db' : type === 'success' ? '#2ecc71' : '#e74c3c';
      messageElement.style.color = 'white';
      messageElement.style.padding = '12px 20px';
      messageElement.style.margin = '10px 0';
      messageElement.style.borderRadius = '4px';
      messageElement.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
      messageElement.style.transition = 'transform 0.3s, opacity 0.3s';
      messageElement.style.transform = 'translateX(100%)';
      messageElement.style.opacity = '0';
      
      // Add to container
      container.appendChild(messageElement);
      
      // Force reflow to enable transition
      messageElement.offsetHeight;
      
      // Show message
      messageElement.style.transform = 'translateX(0)';
      messageElement.style.opacity = '1';
      
      // Remove after duration
      if (duration > 0) {
        setTimeout(function() {
          messageElement.style.transform = 'translateX(100%)';
          messageElement.style.opacity = '0';
          
          // Remove from DOM after transition
          setTimeout(function() {
            if (messageElement.parentNode) {
              messageElement.parentNode.removeChild(messageElement);
            }
          }, 300);
        }, duration);
      }
    }
  </script>
</body>
</html>