<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Practice What's His/Her Job? - Learn he/she, his/her, he's/she's with interactive activities for beginner ESL learners.">
  <title>What's His/Her Job? - Practice Activities</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&family=Source+Code+Pro&display=swap" rel="stylesheet">

  <!-- Base and Activity Styles -->
  <link rel="stylesheet" href="../../css/base.css">
  <link rel="stylesheet" href="../../css/activities.css">
  <link rel="stylesheet" href="../../css/components.css">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../images//favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../images//favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

  <!-- Page specific styles -->
  <style>
    .nav-indicator {
      height: 3px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background-color: var(--beginner-primary);
    }
    
    [data-theme="dark"] .nav-indicator {
      background-color: var(--beginner-primary);
    }
    
    .job-image {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: var(--beginner-icon-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      margin-right: 10px;
    }
    
    /* Story styling for the gap fill */
    .story-container {
      background-color: var(--bg-offset);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .story-container h3 {
      margin-top: 0;
      color: var(--beginner-primary);
    }
    
    .story-text p {
      line-height: 1.8;
      margin-bottom: 15px;
    }
    
    .story-text input {
      width: 70px;
      text-align: center;
    }
  </style>
</head>
<body class="beginner-section">
  <!-- Skip link and theme toggle -->
  <a href="#main-content" class="skip-link">Skip to content</a>
  
  <div class="theme-toggle-container">
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
      <span class="light-icon">‚òÄÔ∏è</span>
      <span class="dark-icon">üåô</span>
    </button>
  </div>

  <!-- Main navigation -->
  <nav class="main-navigation">
    <a href="../../home.html" class="site-logo">
      <img src="../../images/my-logo.svg" alt="English in Doses" width="150" height="auto">
    </a>
    <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
    <div class="nav-links">
      <a href="../../home.html" class="nav-link">Home</a>
      <a href="../../about.html" class="nav-link">About Us</a>
      <a href="../../contact.html" class="nav-link">Contact Us</a>
      <a href="../../home.html#where-to-start" class="nav-link">Grammar</a>
      <a href="../../travel/beginner-travel/travel-english.html" class="nav-link">Travel English</a>
      <a href="../../conversation-page.html" class="nav-link">Conversation</a>
      <a href="../../my-progress.html" class="nav-link">My Progress</a>
      <div class="nav-indicator"></div>
    </div>
  </nav>
<div class="container">
  <!-- Breadcrumbs -->
   <div class="breadcrumbs" aria-label="breadcrumb">
      <span class="breadcrumb-item"><a href="../../home.html">Home</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item"><a href="../../home.html#where-to-start">Grammar Levels</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item"><a href="beginner-grammar.html">Beginner Grammar</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item">What's his/her job?</span>
    </div>

  <div class="container">
    <main id="main-content">
      <h1>What's His/Her Job? - Practice Activities</h1>
      
      <div class=".beginner-section .section-intro">
        <p>Practice using <strong>he/she</strong>, <strong>his/her</strong>, and <strong>he's/she's</strong> when talking about jobs.</p>
        <p>Remember: <span class="highlight">he/she</span> = person, <span class="highlight">his/her</span> = belonging, <span class="highlight">he's/she's</span> = he is/she is</p>
      </div>

      <!-- Activity Navigation -->
      <div class="activity-nav" id="activity-nav">
        <button class="activity-nav-btn active" data-activity="matching">Match Questions</button>
        <button class="activity-nav-btn" data-activity="gap-fill">Fill the Gaps</button>
        <button class="activity-nav-btn" data-activity="drag-drop">Put in Order</button>
      </div>

      <!-- Progress Bar -->
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar">
          <div class="progress-fill"></div>
        </div>
        <div class="progress-info" id="progress-info">0 of 3 activities completed</div>
      </div>

      <!-- Activity 1: Matching Questions to Answers -->
      <section id="matching" class="activity-container active">
        <h2>Match the Question to the Answer</h2>
        <p>Match each question about someone's job to the correct answer.</p>
        
        <div class="matching-container">
          <div class="matching-item">
            <div class="matching-question" data-index="1">
              <div class="job-image">üë®‚Äç‚öïÔ∏è</div>
              What's his job?
            </div>
            <div class="matching-answer" data-index="1">He's a doctor.</div>
          </div>
          
          <div class="matching-item">
            <div class="matching-question" data-index="2">
              <div class="job-image">üë©‚Äçüè´</div>
              What's her job?
            </div>
            <!-- Reordered answers start here -->
            <div class="matching-answer" data-index="4">She's a pilot.</div>
          </div>
          
          <div class="matching-item">
            <div class="matching-question" data-index="3">
              <div class="job-image">üë®‚Äçüç≥</div>
              What's his job?
            </div>
            <div class="matching-answer" data-index="5">He's a manager.</div>
          </div>
          
          <div class="matching-item">
            <div class="matching-question" data-index="4">
              <div class="job-image">üë©‚Äç‚úàÔ∏è</div>
              What's her job?
            </div>
            <div class="matching-answer" data-index="3">He's a chef.</div>
          </div>
          
          <div class="matching-item">
            <div class="matching-question" data-index="5">
              <div class="job-image">üë®‚Äçüíº</div>
              What's his job?
            </div>
            <div class="matching-answer" data-index="2">She's a teacher.</div>
          </div>
        </div>
        
        <div class="control-buttons">
          <button id="matching-restart" class="restart-btn" style="display:none;">Try Again</button>
        </div>
        
        <div class="score-display" id="matching-score" style="display:none;">
          Your score: <span>0</span>/5
        </div>
      </section>

      <!-- Activity 2: Gap Fill - Completely new story -->
      <section id="gap-fill" class="activity-container">
        <h2>Fill in the Gaps</h2>
        <p>Complete the story about Sarah and Tom by filling in the gaps with <strong>he</strong>, <strong>she</strong>, <strong>his</strong>, <strong>her</strong>, <strong>he's</strong>, or <strong>she's</strong>.</p>
        
        <div class="story-container">
          <h3>Meet Sarah and Tom</h3>
          
          <div class="story-text">
            <p>Sarah is a doctor. <input type="text" class="gap-input" data-answer="She" placeholder="?"> works at City Hospital. <input type="text" class="gap-input" data-answer="Her" placeholder="?"> job is very important. <input type="text" class="gap-input" data-answer="She's" placeholder="?"> very busy every day.</p>
            
            <p>Tom is a teacher. <input type="text" class="gap-input" data-answer="He" placeholder="?"> teaches English at a school. <input type="text" class="gap-input" data-answer="His" placeholder="?"> students love <input type="text" class="gap-input" data-answer="him" placeholder="?"> because <input type="text" class="gap-input" data-answer="he's" placeholder="?"> very friendly.</p>
            
            <p>Sarah and Tom are friends. Sometimes <input type="text" class="gap-input" data-answer="she" placeholder="?"> visits Tom at school. <input type="text" class="gap-input" data-answer="He" placeholder="?"> always makes coffee for <input type="text" class="gap-input" data-answer="her" placeholder="?">.</p>
            
            <p>"What's <input type="text" class="gap-input" data-answer="your" placeholder="?"> job?" people often ask Sarah.</p>
            
            <p>"<input type="text" class="gap-input" data-answer="I'm" placeholder="?"> a doctor," <input type="text" class="gap-input" data-answer="she" placeholder="?"> answers.</p>
            
            <p>When people ask Tom about <input type="text" class="gap-input" data-answer="his" placeholder="?"> job, <input type="text" class="gap-input" data-answer="he" placeholder="?"> says, "<input type="text" class="gap-input" data-answer="I'm" placeholder="?"> a teacher."</p>
          </div>
        </div>
        
        <div class="control-buttons">
          <button id="gap-fill-submit" class="submit-btn">Check Answers</button>
          <button id="gap-fill-restart" class="restart-btn" style="display:none;">Try Again</button>
        </div>
        
        <div class="score-display" id="gap-fill-score" style="display:none;">
          Your score: <span>0</span>/15
        </div>
      </section>

      <!-- Activity 3: Drag and Drop Word Order - Fixed to not show answers in question -->
      <section id="drag-drop" class="activity-container">
        <h2>Put the Words in Order</h2>
        <p>Drag the words to make correct sentences about jobs.</p>
        
        <div class="question" id="dd1">
          <p class="question-text">Make a question:</p>
          <div class="drop-zone" data-answer="what's his job?"></div>
          <div class="drag-items">
            <div class="drag-item" draggable="true">What's</div>
            <div class="drag-item" draggable="true">his</div>
            <div class="drag-item" draggable="true">job?</div>
          </div>
          <div class="feedback"></div>
        </div>
        
        <div class="question" id="dd2">
          <p class="question-text">Make an answer:</p>
          <div class="drop-zone" data-answer="she's a teacher."></div>
          <div class="drag-items">
            <div class="drag-item" draggable="true">She's</div>
            <div class="drag-item" draggable="true">a</div>
            <div class="drag-item" draggable="true">teacher.</div>
          </div>
          <div class="feedback"></div>
        </div>
        
        <div class="question" id="dd3">
          <p class="question-text">Make a question:</p>
          <div class="drop-zone" data-answer="what's her job?"></div>
          <div class="drag-items">
            <div class="drag-item" draggable="true">What's</div>
            <div class="drag-item" draggable="true">her</div>
            <div class="drag-item" draggable="true">job?</div>
          </div>
          <div class="feedback"></div>
        </div>
        
        <div class="question" id="dd4">
          <p class="question-text">Make an answer:</p>
          <div class="drop-zone" data-answer="he's a doctor."></div>
          <div class="drag-items">
            <div class="drag-item" draggable="true">He's</div>
            <div class="drag-item" draggable="true">a</div>
            <div class="drag-item" draggable="true">doctor.</div>
          </div>
          <div class="feedback"></div>
        </div>
        
        <div class="question" id="dd5">
          <p class="question-text">Make a question:</p>
          <div class="drop-zone" data-answer="is she a nurse?"></div>
          <div class="drag-items">
            <div class="drag-item" draggable="true">Is</div>
            <div class="drag-item" draggable="true">she</div>
            <div class="drag-item" draggable="true">a</div>
            <div class="drag-item" draggable="true">nurse?</div>
          </div>
          <div class="feedback"></div>
        </div>
        
        <div class="control-buttons">
          <button id="drag-drop-submit" class="submit-btn">Check Answers</button>
          <button id="drag-drop-restart" class="restart-btn" style="display:none;">Try Again</button>
        </div>
        
        <div class="score-display" id="drag-drop-score" style="display:none;">
          Your score: <span>0</span>/5
        </div>
      </section>
    </main>
  </div>
</div>
  
  <!-- Bottom Navigation -->
  <nav class="bottom-navigation">
    <a href="beginner-grammar.html" class="nav-button previous">‚Üê Back to: Beginner Grammar</a>
    <div class="center-buttons">
      <button class="nav-button print-button" onclick="window.print()">Print This Page</button>
    </div>
    <a href="../../my-progress.html" class="nav-button next">View My Progress ‚Üí</a>
  </nav>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="../../home.html">Home</a></li>
          <li><a href="../../home.html#where-to-start">Grammar</a></li>
          <li><a href="../../extra-practice.html">Extra Practice</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Grammar Topics</h3>
        <ul>
          <li><a href="beginner-grammar.html#basic-grammar">Basic Grammar</a></li>
          <li><a href="beginner-grammar.html#present-simple">Present Simple</a></li>
          <li><a href="beginner-grammar.html#question-words">Question Words</a></li>
          <li><a href="beginner-grammar.html#jobs-vocabulary">Jobs Vocabulary</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Connect</h3>
        <ul>
          <li><a href="../../about.html">About</a></li>
          <li><a href="../../contact.html">Contact</a></li>
          <li><a href="../../privacy.html">Privacy Policy</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>¬© 2025 English in Doses | All rights reserved | <a href="../../license.html">Licensing Information</a></p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="../../js/core.js"></script>
  <script src="../../js/matching.js"></script>
  <script src="../../js/gap-fill.js"></script>
  <script src="../../js/drag-drop.js"></script>
  <script src="../../js/activity-nav.js"></script>
  <script src="../../js/progress-tracking-module.js"></script>
  <script src="../../js/progress-manager-ui.js"></script>
  <script src="../../js/init-progress.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Check if modules are available first
      console.log('Available modules:', {
        matching: typeof MatchingModule !== 'undefined',
        gapFill: typeof GapFillModule !== 'undefined', 
        dragDrop: typeof DragDropModule !== 'undefined',
        activityNav: typeof ActivityNavModule !== 'undefined',
        progress: typeof ProgressTrackingModule !== 'undefined'
      });
      
      // Initialize activity modules based on your infrastructure
      if (typeof MatchingModule !== 'undefined') {
        MatchingModule.init({
          containerId: 'matching',
          onComplete: function(score, total) {
            if (typeof ProgressTrackingModule !== 'undefined') {
              ProgressTrackingModule.updateItemProgress('activities', 'jobs-matching', {
                completed: true,
                score: score,
                maxScore: total
              });
            }
            if (typeof ActivityNavModule !== 'undefined') {
              ActivityNavModule.notifyActivityCompleted('matching', {
                score: score,
                maxScore: total
              });
            }
          }
        });
      }
      
      if (typeof GapFillModule !== 'undefined') {
        GapFillModule.init({
          containerId: 'gap-fill',
          onComplete: function(score, total) {
            if (typeof ProgressTrackingModule !== 'undefined') {
              ProgressTrackingModule.updateItemProgress('activities', 'jobs-gap-fill', {
                completed: true,
                score: score,
                maxScore: total
              });
            }
            if (typeof ActivityNavModule !== 'undefined') {
              ActivityNavModule.notifyActivityCompleted('gap-fill', {
                score: score,
                maxScore: total
              });
            }
          }
        });
      }
      
      if (typeof DragDropModule !== 'undefined') {
        // Store the original drag items for each question
        const originalDragItems = {};
        
        document.querySelectorAll('#drag-drop .question').forEach((question) => {
          const questionId = question.id;
          const dragItemsContainer = question.querySelector('.drag-items');
          
          if (dragItemsContainer) {
            // Store the original word texts only
            originalDragItems[questionId] = Array.from(dragItemsContainer.querySelectorAll('.drag-item')).map(
              item => item.textContent
            );
          }
        });
        
        // Override the init function to fix answer checking
        const originalInit = DragDropModule.init;
        
        DragDropModule.init = function(config = {}) {
          const container = document.getElementById(config.containerId || 'drag-drop');
          if (!container) return originalInit(config);
          
          // Extract the correct answers from drop zones' data-answer attributes
          const answers = {};
          container.querySelectorAll('.drop-zone').forEach((zone, index) => {
            const answer = zone.getAttribute('data-answer');
            if (answer) {
              answers[index] = answer.toLowerCase();
            }
          });
          
          // Call the original init with our extracted answers
          const newConfig = {
            ...config,
            answers: answers,
            allowMultipleCorrectOrders: false
          };
          
          return originalInit(newConfig);
        };
        
        // Initialize with the fixed init function
        DragDropModule.init({
          containerId: 'drag-drop',
          onComplete: function(score, total) {
            if (typeof ProgressTrackingModule !== 'undefined') {
              ProgressTrackingModule.updateItemProgress('activities', 'jobs-drag-drop', {
                completed: true,
                score: score,
                maxScore: total
              });
            }
            if (typeof ActivityNavModule !== 'undefined') {
              ActivityNavModule.notifyActivityCompleted('drag-drop', {
                score: score,
                maxScore: total
              });
            }
          }
        });
        
        // Fix the restart button to prevent duplicatable items
        const restartButton = document.getElementById('drag-drop-restart');
        if (restartButton) {
          // Replace any existing event listeners by cloning the button
          const newRestartButton = restartButton.cloneNode(true);
          if (restartButton.parentNode) {
            restartButton.parentNode.replaceChild(newRestartButton, restartButton);
          }
          
          // Add our fixed event listener
          newRestartButton.addEventListener('click', function() {
            // Get all questions
            document.querySelectorAll('#drag-drop .question').forEach((question) => {
              const questionId = question.id;
              
              // Clear the drop zone
              const dropZone = question.querySelector('.drop-zone');
              if (dropZone) {
                dropZone.innerHTML = '';
                dropZone.style.borderColor = 'var(--border-color)';
                dropZone.style.backgroundColor = 'var(--drop-zone-bg)';
              }
              
              // Get the drag items container
              const dragItemsContainer = question.querySelector('.drag-items');
              if (dragItemsContainer) {
                // Clear all existing items
                dragItemsContainer.innerHTML = '';
                
                // Recreate the drag items from the stored words
                if (originalDragItems[questionId]) {
                  originalDragItems[questionId].forEach(word => {
                    const newItem = document.createElement('div');
                    newItem.className = 'drag-item';
                    newItem.setAttribute('draggable', 'true');
                    newItem.textContent = word;
                    
                    // Add fresh event listeners
                    newItem.addEventListener('dragstart', function(e) {
                      this.classList.add('dragging');
                      e.dataTransfer.setData('text/plain', this.textContent);
                      e.dataTransfer.effectAllowed = 'move';
                      window.currentDraggedItem = this;
                    });
                    
                    newItem.addEventListener('dragend', function() {
                      this.classList.remove('dragging');
                      window.currentDraggedItem = null;
                    });
                    
                    dragItemsContainer.appendChild(newItem);
                  });
                }
              }
              
              // Clear feedback
              const feedback = question.querySelector('.feedback');
              if (feedback) {
                feedback.textContent = '';
                feedback.className = 'feedback';
              }
            });
            
            // Toggle buttons
            const submitButton = document.getElementById('drag-drop-submit');
            if (submitButton) {
              submitButton.style.display = 'block';
              newRestartButton.style.display = 'none';
            }
            
            // Hide score
            const scoreDisplay = document.getElementById('drag-drop-score');
            if (scoreDisplay) {
              scoreDisplay.style.display = 'none';
            }
          });
        }
      }
      
      // Initialize Activity Navigation
      if (typeof ActivityNavModule !== 'undefined') {
        ActivityNavModule.init({
          containerId: 'activity-nav',
          activities: ['matching', 'gap-fill', 'drag-drop'],
          progressContainerId: 'progress-bar',
          progressInfoContainerId: 'progress-info',
          onActivityChange: function(activityId) {
            console.log('Activity changed to:', activityId);
          }
        });
      }
      
      // Initialize Progress Tracking
      if (typeof ProgressTrackingModule !== 'undefined') {
        ProgressTrackingModule.init({
          categories: {
            activities: {
              grammarActivities: ['jobs-matching', 'jobs-gap-fill', 'jobs-drag-drop']
            }
          },
          onProgressChange: function(details) {
            if (typeof ActivityNavModule !== 'undefined') {
              ActivityNavModule.updateProgressDisplay();
            }
          }
        });
      }
    });
  </script>
</body>
</html>