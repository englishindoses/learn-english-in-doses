<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Include standardized head content -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Present Perfect Progressive vs Present Perfect Simple - Advanced ESL grammar explanation with examples and practice">
  <title>Present Perfect Progressive vs Present Perfect Simple - Advanced ESL Grammar</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&family=Source+Code+Pro&display=swap" rel="stylesheet">
  
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../images//favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../images//favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  
  <!-- Styles -->
  <link rel="stylesheet" href="../../css/base.css">
  <link rel="stylesheet" href="../../css/activities.css">
  <link rel="stylesheet" href="../../css/progress-tracking-styles.css">
</head>
<body>
  <!-- Include skip link and theme toggle -->
  <a href="#main-content" class="skip-link">Skip to content</a>
  
  <div class="theme-toggle-container">
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
      <span class="light-icon">‚òÄÔ∏è</span>
      <span class="dark-icon">üåô</span>
    </button>
  </div>
  
  <!-- Include navigation -->
  <nav class="main-navigation">
    <a href="../../home.html" class="site-logo">
      <img src="../../images/my-logo.svg" alt="English in Doses" width="150" height="auto">
    </a>
    <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
    <div class="nav-links">
      <a href="../../home.html" class="nav-link">Home</a>
      <a href="../../about.html" class="nav-link">About Us</a>
      <a href="../../contact.html" class="nav-link">Contact Us</a>
      <a href="../../home.html#where-to-start" class="nav-link">Grammar</a>
      <a href="../../extra-practice.html" class="nav-link">Extra Practice</a>
      <a href="../../conversation-page.html" class="nav-link">Conversation</a>
      <a href="../../my-progress.html" class="nav-link">My Progress</a>
    </div>

    <div class="advanced-nav-indicator"></div>
    
  </nav>

  <div class="container">
    <!-- Include breadcrumbs -->
    <div class="breadcrumbs" aria-label="breadcrumb">
      <span class="breadcrumb-item"><a href="../../home.html">Home</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item"><a href="advanced-grammar.html">Advanced Grammar</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item"><a href="advanced-grammar.html#advanced-tenses-and-aspect">Advanced Tenses</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item">Present Perfect Progressive vs Present Perfect Simple</span>
    </div>

    <main id="main-content">
      <h1>Present Perfect Progressive vs Present Perfect Simple</h1>

      <!-- INTRODUCTION SECTION -->
      <section class="intro-section">
        <h2>Introduction</h2>
        <p>Both Present Perfect Progressive and Present Perfect Simple connect past actions to the present moment, but they focus on different aspects of the action. Understanding when to use each tense will help you express yourself more precisely and sound more natural in English.</p>
        
        <h3>After this lesson, you will be able to:</h3>
        <ul>
          <li>Understand the key differences between Present Perfect Progressive and Present Perfect Simple</li>
          <li>Use both tenses correctly in conversations and writing</li>
          <li>Choose the right tense based on your communication purpose</li>
        </ul>
      </section>

      <!-- GRAMMAR POINT SECTION 1 -->
      <section class="grammar-point">
        <h2>Present Perfect Simple: Form and Usage</h2>
        
        <p><strong>Form</strong>: subject + have/has + past participle</p>
        
        <p><strong>Main uses</strong>: The Present Perfect Simple emphasises completed actions, results, achievements, and experiences up to the present moment.</p>
        
        <div class="example">
          <ol>
            <li>I <strong>have finished</strong> my homework. (The homework is now complete)</li>
            <li>She <strong>has visited</strong> Paris three times. (Emphasis on the experience and how many times)</li>
            <li>They <strong>have lived</strong> in London for five years. (They still live there)</li>
          </ol>
        </div>
        
        <div class="note">
          <p><strong>Native speaker note:</strong> Native speakers often use Present Perfect Simple with time expressions like "just," "already," "yet," "ever," and "never". Example: "I've just eaten lunch" or "Have you ever visited Spain?"</p>
        </div>
      </section>

      <!-- GRAMMAR POINT SECTION 2 -->
      <section class="grammar-point">
        <h2>Present Perfect Progressive: Form and Usage</h2>
        
        <p><strong>Form</strong>: subject + have/has + been + verb-ing</p>
        
        <p><strong>Main uses</strong>: The Present Perfect Progressive emphasises the ongoing nature, duration, or temporary nature of an action that started in the past and continues to the present.</p>
        
        <div class="example">
          <ol>
            <li>I <strong>have been studying</strong> English for three years. (Focus on the ongoing activity)</li>
            <li>She <strong>has been waiting</strong> for the bus for 30 minutes. (Emphasises the duration and that she's still waiting)</li>
            <li>They <strong>have been working</strong> on this project since January. (The action is still in progress)</li>
          </ol>
        </div>
        
        <div class="note">
          <p><strong>Native speaker note:</strong> Native speakers often use Present Perfect Progressive to explain a current situation, especially when there are visible results or when someone looks tired/busy: "Sorry about the mess. I've been painting the kitchen."</p>
        </div>
      </section>

      <!-- GRAMMAR POINT SECTION 3 -->
      <section class="grammar-point">
        <h2>Choosing Between the Two Tenses</h2>
        
        <p><strong>Key differences</strong>: Your choice depends on what aspect of the action you want to emphasise.</p>
        
        <div class="example">
          <p><strong>Compare these pairs:</strong></p>
          <ol>
            <li>I <strong>have read</strong> three books this week. (Completed action, focus on result - three finished books)</li>
            <li>I <strong>have been reading</strong> this book all week. (Ongoing activity, focus on the process - still reading)</li>
            <br>
            <li>She <strong>has cleaned</strong> the house. (Focus on result - the house is now clean)</li>
            <li>She <strong>has been cleaning</strong> the house. (Focus on the activity itself, may not be finished)</li>
            <br>
            <li>They <strong>have lived</strong> here for 10 years. (Simple state, focus on the whole period)</li>
            <li>They <strong>have been living</strong> here for 10 years. (More emphasis on the ongoing situation)</li>
          </ol>
        </div>
        
        <div class="note">
          <p><strong>Native speaker note:</strong> With some verbs like "live," "work," and "teach," native speakers often use both forms interchangeably: "I've worked here for five years" and "I've been working here for five years" are both natural.</p>
        </div>
      </section>

      <!-- VISUAL COMPARISON TABLE -->
      <section>
        <h2>Comparing Present Perfect Simple and Progressive</h2>
        <table>
          <thead>
            <tr>
              <th>Aspect</th>
              <th>Present Perfect Simple</th>
              <th>Present Perfect Progressive</th>
              <th>Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Focus</td>
              <td>Completion and result</td>
              <td>Process and duration</td>
              <td><span class="example">I've written a report. vs. I've been writing a report.</span></td>
            </tr>
            <tr>
              <td>Time expressions</td>
              <td>Often with: ever, never, just, already, yet</td>
              <td>Often with: for, since, all day/week, lately, recently</td>
              <td><span class="example">I've already called him. vs. I've been calling him all day.</span></td>
            </tr>
            <tr>
              <td>Multiple actions</td>
              <td>Counts number of completed actions</td>
              <td>Considers the activity as a whole</td>
              <td><span class="example">I've seen that movie three times. vs. I've been watching movies all weekend.</span></td>
            </tr>
            <tr>
              <td>Duration</td>
              <td>States the fact of duration</td>
              <td>Emphasises the continuity of duration</td>
              <td><span class="example">She's lived here for 5 years. vs. She's been living here for 5 years.</span></td>
            </tr>
            <tr>
              <td>Present result</td>
              <td>Focus on the result now</td>
              <td>Focus on the activity that caused the result</td>
              <td><span class="example">I've hurt my back. vs. I've been lifting heavy boxes.</span></td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- COMMON ERRORS SECTION -->
      <section class="common-errors">
        <h2 class="common-errors-heading">Common Errors</h2>
        
        <div class="error-pattern">
          <p class="error-title"><strong>1: Using Present Perfect Simple when focusing on an activity in progress</strong></p>
          <p class="incorrect">I have painted the wall for three hours. The paint is still wet.</p>
          <p class="correct">I have been painting the wall for three hours. The paint is still wet. ‚úì</p>
          <p class="explanation"><em>When you want to emphasise that an activity is ongoing or temporary, use the Present Perfect Progressive.</em></p>
        </div>
        
        <div class="error-pattern">
          <p class="error-title"><strong>2: Using Present Perfect Progressive when focusing on completed actions or results</strong></p>
          <p class="incorrect">I have been finished my homework, so I can go out now.</p>
          <p class="correct">I have finished my homework, so I can go out now. ‚úì</p>
          <p class="explanation"><em>For completed actions with a present result, use the Present Perfect Simple.</em></p>
        </div>
        
        <div class="error-pattern">
          <p class="error-title"><strong>3: Using Present Perfect Progressive with stative verbs</strong></p>
          <p class="incorrect">I have been knowing him for ten years.</p>
          <p class="correct">I have known him for ten years. ‚úì</p>
          <p class="explanation"><em>Stative verbs (like know, believe, want, love) are not normally used in continuous forms.</em></p>
        </div>
      </section>

      <!-- TIPS SECTION -->
      <section class="tips">
        <h2 class="tips-heading">Useful Tips</h2>
        
        <div class="grammar-tip">
          <p>üìù <strong>TIP 1:</strong> Ask yourself what you want to focus on: if it's the result or completion of an action, use Present Perfect Simple. If it's the process, duration, or ongoing nature, use Present Perfect Progressive.</p>
        </div>
        
        <div class="grammar-tip">
          <p>üìù <strong>TIP 2:</strong> Remember that stative verbs (be, have, know, like, love, hate, understand, etc.) are usually used in the Present Perfect Simple, not Progressive.</p>
        </div>
        
        <div class="grammar-tip">
          <p>üìù <strong>TIP 3:</strong> Pay attention to time expressions: "already," "yet," "ever," and "never" are commonly used with Present Perfect Simple, while "for," "since," "all day/week," and "lately" are often used with Present Perfect Progressive.</p>
        </div>
      </section>

      <!-- MCQ PRACTICE SECTION -->
      <section class="content-section mcq-container">
        <h2>Quick Practice</h2>
        <p class="mcq-instructions">Test your understanding of Present Perfect Simple vs. Present Perfect Progressive. Questions progress from basic to more challenging levels.</p>
        
        <!-- Progress indicator -->
        <div class="mcq-progress">
          <div class="progress-container">
            <div id="mcq-progress-bar" class="progress-bar" style="width: 0%"></div>
          </div>
          <div class="progress-info">Question: <span id="current-question">1</span>/<span id="total-questions">5</span></div>
        </div>
        
        <div id="mcq-container" class="activity-container active">
          <div class="questions-container">
            <!-- Question 1 - Basic level -->
            <div id="q1" class="question" data-difficulty="basic">
              <p class="question-number">Question 1</p>
              <div class="question-context">
                <p class="mcq-question">I'm very tired because I _____ all day.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q1-option0" name="q1" value="0">
                  <label for="q1-option0">have studied</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q1-option1" name="q1" value="1">
                  <label for="q1-option1">have been studying</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q1-option2" name="q1" value="2">
                  <label for="q1-option2">study</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q1-option3" name="q1" value="3">
                  <label for="q1-option3">studied</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>

            <!-- Question 2 - Basic level -->
            <div id="q2" class="question" data-difficulty="basic">
              <p class="question-number">Question 2</p>
              <div class="question-context">
                <p class="mcq-question">She _____ three cups of coffee today.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q2-option0" name="q2" value="0">
                  <label for="q2-option0">has drunk</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q2-option1" name="q2" value="1">
                  <label for="q2-option1">has been drinking</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q2-option2" name="q2" value="2">
                  <label for="q2-option2">drinks</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q2-option3" name="q2" value="3">
                  <label for="q2-option3">is drinking</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>

            <!-- Question 3 - Intermediate level -->
            <div id="q3" class="question" data-difficulty="intermediate">
              <p class="question-number">Question 3</p>
              <div class="question-context">
                <p class="mcq-question">Why are your clothes so wet? _____ in the rain?</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q3-option0" name="q3" value="0">
                  <label for="q3-option0">Have you been walking</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q3-option1" name="q3" value="1">
                  <label for="q3-option1">Have you walked</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q3-option2" name="q3" value="2">
                  <label for="q3-option2">Did you walk</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q3-option3" name="q3" value="3">
                  <label for="q3-option3">Do you walk</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>

            <!-- Question 4 - Intermediate level -->
            <div id="q4" class="question" data-difficulty="intermediate">
              <p class="question-number">Question 4</p>
              <div class="question-context">
                <p class="mcq-question">I _____ my keys. I can't find them anywhere.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q4-option0" name="q4" value="0">
                  <label for="q4-option0">am losing</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q4-option1" name="q4" value="1">
                  <label for="q4-option1">have lost</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q4-option2" name="q4" value="2">
                  <label for="q4-option2">have been losing</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q4-option3" name="q4" value="3">
                  <label for="q4-option3">lose</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>

            <!-- Question 5 - Advanced level -->
            <div id="q5" class="question" data-difficulty="advanced">
              <p class="question-number">Question 5</p>
              <div class="question-context">
                <p class="mcq-question">We _____ in this flat since 2010.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q5-option0" name="q5" value="0">
                  <label for="q5-option0">live</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q5-option1" name="q5" value="1">
                  <label for="q5-option1">are living</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q5-option2" name="q5" value="2">
                  <label for="q5-option2">have lived</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q5-option3" name="q5" value="3">
                  <label for="q5-option3">have been lived</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
          </div>
          
          <!-- Navigation buttons -->
          <div class="question-navigation">
            <button id="prev-question" class="nav-button" disabled>Previous</button>
            <button id="next-question" class="nav-button">Next</button>
          </div>
          
          <!-- Control buttons -->
          <div class="control-buttons">
            <button id="mcq-submit" class="submit-btn">Check Answers</button>
            <button id="mcq-restart" class="restart-btn" style="display:none;">Try Again</button>
            <a href="#grammar-summary" id="check-grammar" class="nav-button" style="display:none;">Review Grammar</a>
          </div>
          
          <!-- Results summary -->
          <div id="mcq-results" class="results-container" style="display:none;">
            <h3>Your Results</h3>
            <div class="score-display">
              <p>Your score: <span id="score-value">0</span>/<span id="total-questions-score">5</span></p>
              <div class="progress-container">
                <div id="results-progress-bar" class="progress-bar" style="width: 0%"></div>
              </div>
            </div>
            <div class="difficulty-breakdown">
              <div class="difficulty-section">
                <h4>Basic (Questions 1-2)</h4>
                <p><span id="basic-score">0</span>/2 correct</p>
              </div>
              <div class="difficulty-section">
                <h4>Intermediate (Questions 3-4)</h4>
                <p><span id="intermediate-score">0</span>/2 correct</p>
              </div>
              <div class="difficulty-section">
                <h4>Advanced (Question 5)</h4>
                <p><span id="advanced-score">0</span>/1 correct</p>
              </div>
            </div>
            <div class="feedback-summary">
              <p>Review your answers above to see explanations for each question.</p>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Grammar summary section (target for "Check the Grammar" button) -->
      <section id="grammar-summary" class="grammar-summary">
        <h2>Key Points to Remember</h2>
        <ul>
          <li><strong>Present Perfect Simple</strong> (have/has + past participle): Use for completed actions, results, and achievements</li>
          <li><strong>Present Perfect Progressive</strong> (have/has + been + verb-ing): Use for ongoing actions, duration, and temporary actions</li>
          <li>Use Present Perfect Simple with stative verbs (know, believe, love, etc.)</li>
          <li>Time expressions like "already," "just," "ever," "never" typically go with Present Perfect Simple</li>
          <li>Time expressions like "for," "since," "lately," "all day/week" typically go with Present Perfect Progressive</li>
        </ul>
      </section>
    </main>
  </div>
  
  <!-- BOTTOM NAVIGATION -->
  <nav class="bottom-navigation">
    <a href="advanced-grammar.html#advanced-tenses-and-aspect" class="nav-button previous">‚Üê Previous: Advanced Tenses Overview</a>
    <div class="center-buttons">
      <button class="nav-button print-button" onclick="window.print()">Print This Page</button>
      <a href="present-perfect-progressive-practice.html" class="nav-button activities">Practice Activities</a>
    </div>
    <a href="past-perfect-progressive.html" class="nav-button next">Next: Past Perfect Progressive ‚Üí</a>
  </nav>

  <!-- Include footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="../../home.html">Home</a></li>
          <li><a href="../../home.html#where-to-start">Grammar</a></li>
          <li><a href="../../extra-practice.html">Extra Practice</a></li>
          <li><a href="../../my-progress.html">My Progress</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Grammar Topics</h3>
        <ul>
          <li><a href="advanced-grammar.html#advanced-tenses-and-aspect">Advanced Tenses</a></li>
          <li><a href="advanced-grammar.html#conditionals">Advanced Conditionals</a></li>
          <li><a href="advanced-grammar.html#modals">Advanced Modal Verbs</a></li>
          <li><a href="advanced-grammar.html#passive">Advanced Passive Voice</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Connect</h3>
        <ul>
          <li><a href="../../about.html">About</a></li>
          <li><a href="../../contact.html">Contact</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>¬© 2025 English in Doses | All rights reserved | <a href="../../license.html">Licensing Information</a></p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="../../js/core.js"></script>
  <script src="../../js/mcq.js"></script>
  <script src="../../js/progress-tracking.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize MCQ Module with new MCQ system
      const totalQuestions = document.querySelectorAll('#mcq-container .question').length;
      document.getElementById('total-questions').textContent = totalQuestions;
      document.getElementById('total-questions-score').textContent = totalQuestions;
      
      // Show only the first question initially
      showQuestion(1);
      
      // Set up navigation
      document.getElementById('next-question').addEventListener('click', function() {
        const currentQuestionNum = parseInt(document.getElementById('current-question').textContent);
        if (currentQuestionNum < totalQuestions) {
          showQuestion(currentQuestionNum + 1);
        }
      });
      
      document.getElementById('prev-question').addEventListener('click', function() {
        const currentQuestionNum = parseInt(document.getElementById('current-question').textContent);
        if (currentQuestionNum > 1) {
          showQuestion(currentQuestionNum - 1);
        }
      });
      
      // Check Answers
      document.getElementById('mcq-submit').addEventListener('click', function() {
        // Hide navigation buttons
        document.getElementById('next-question').style.display = 'none';
        document.getElementById('prev-question').style.display = 'none';
        
        // Show all questions for review
        document.querySelectorAll('#mcq-container .question').forEach(question => {
          question.style.display = 'block';
        });
        
        // Calculate scores
        const answers = {
          'q1': 1,  // have been studying
          'q2': 0,  // has drunk
          'q3': 0,  // Have you been walking
          'q4': 1,  // have lost
          'q5': 2   // have lived
        };
        
        const explanations = {
          'q1': 'Present Perfect Progressive is used to emphasize the continuous activity (studying all day) that has caused the current state (being tired).',
          'q2': 'Present Perfect Simple is used to count completed actions (three cups of coffee).',
          'q3': 'Present Perfect Progressive is used for a recent continuous activity with visible present results (wet clothes).',
          'q4': 'Present Perfect Simple is used for a completed action with present consequences (keys are now lost).',
          'q5': 'Present Perfect Simple is commonly used with stative verbs like "live" for states that continue to the present.'
        };
        
        let totalScore = 0;
        let basicScore = 0;
        let intermediateScore = 0;
        let advancedScore = 0;
        
        // Check each question
        Object.keys(answers).forEach(questionId => {
          const question = document.getElementById(questionId);
          const selectedOption = question.querySelector('input[type="radio"]:checked');
          const feedback = question.querySelector('.feedback');
          
          if (selectedOption) {
            const selectedIndex = parseInt(selectedOption.value);
            const correctIndex = answers[questionId];
            
            if (selectedIndex === correctIndex) {
              feedback.innerHTML = `<p class="correct-feedback">‚úì Correct! ${explanations[questionId]}</p>`;
              totalScore++;
              
              // Update difficulty scores
              const difficulty = question.getAttribute('data-difficulty');
              if (difficulty === 'basic') basicScore++;
              if (difficulty === 'intermediate') intermediateScore++;
              if (difficulty === 'advanced') advancedScore++;
            } else {
              const correctOptionLabel = question.querySelector(`label[for="${questionId}-option${correctIndex}"]`).textContent;
              feedback.innerHTML = `<p class="incorrect-feedback">‚úó Incorrect. The correct answer is: ${correctOptionLabel}</p><p>${explanations[questionId]}</p>`;
            }
          } else {
            feedback.innerHTML = '<p class="incorrect-feedback">No answer selected.</p>';
          }
        });
        
        // Update score display
        document.getElementById('score-value').textContent = totalScore;
        document.getElementById('basic-score').textContent = basicScore;
        document.getElementById('intermediate-score').textContent = intermediateScore;
        document.getElementById('advanced-score').textContent = advancedScore;
        
        // Update progress bar
        const percentage = (totalScore / totalQuestions) * 100;
        document.getElementById('results-progress-bar').style.width = percentage + '%';
        
        // Show results
        document.getElementById('mcq-results').style.display = 'block';
        document.getElementById('mcq-submit').style.display = 'none';
        document.getElementById('mcq-restart').style.display = 'inline-block';
        document.getElementById('check-grammar').style.display = 'inline-block';
        
        // Track progress
        if (typeof ProgressTrackingModule !== 'undefined') {
          ProgressTrackingModule.markItemCompleted('activities', 'mcq-present-perfect-progressive', {
            score: totalScore,
            maxScore: totalQuestions,
            completed: true,
            completedAt: new Date().toISOString(),
            title: 'Present Perfect Progressive vs Simple Quick Practice'
          });
          
          // Also mark the lesson as viewed/completed
          ProgressTrackingModule.updateItemProgress('lessons', 'present-perfect-progressive', {
            lastViewed: new Date().toISOString(),
            progress: 100,
            title: 'Present Perfect Progressive vs Present Perfect Simple'
          });
        }
      });
      
      // Restart Quiz
      document.getElementById('mcq-restart').addEventListener('click', function() {
        // Reset all selections and feedback
        document.querySelectorAll('#mcq-container input[type="radio"]').forEach(radio => {
          radio.checked = false;
        });
        
        document.querySelectorAll('#mcq-container .feedback').forEach(feedback => {
          feedback.innerHTML = '';
        });
        
        // Show only first question again
        showQuestion(1);
        
        // Reset UI
        document.getElementById('next-question').style.display = 'inline-block';
        document.getElementById('prev-question').style.display = 'inline-block';
        document.getElementById('mcq-results').style.display = 'none';
        document.getElementById('mcq-submit').style.display = 'inline-block';
        document.getElementById('mcq-restart').style.display = 'none';
        document.getElementById('check-grammar').style.display = 'none';
      });
      
      // Helper function to show a specific question
      function showQuestion(questionNumber) {
        // Hide all questions
        document.querySelectorAll('#mcq-container .question').forEach(question => {
          question.style.display = 'none';
        });
        
        // Show the selected question
        const questions = document.querySelectorAll('#mcq-container .question');
        if (questionNumber > 0 && questionNumber <= questions.length) {
          questions[questionNumber - 1].style.display = 'block';
        }
        
        // Update current question display
        document.getElementById('current-question').textContent = questionNumber;
        
        // Update progress bar
        const percentage = ((questionNumber - 1) / (questions.length - 1)) * 100;
        document.getElementById('mcq-progress-bar').style.width = percentage + '%';
        
        // Enable/disable navigation buttons
        document.getElementById('prev-question').disabled = (questionNumber === 1);
        document.getElementById('next-question').disabled = (questionNumber === questions.length);
      }
    });
  </script>
</body>
</html>