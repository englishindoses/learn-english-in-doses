<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Include standardized head content -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Past Perfect Progressive vs. Past Perfect - Advanced ESL grammar explanation with examples and practice">
  <title>Past Perfect Progressive vs. Past Perfect - Advanced ESL Grammar</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@400;600&family=Source+Code+Pro&display=swap" rel="stylesheet">
  
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../images//favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../images//favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  
  <!-- Styles -->
  <link rel="stylesheet" href="../../css/base.css">
  <link rel="stylesheet" href="../../css/activities.css">
  <link rel="stylesheet" href="../../css/progress-tracking-styles.css">
</head>
<body>
  <!-- Include skip link and theme toggle -->
  <a href="#main-content" class="skip-link">Skip to content</a>
  
  <div class="theme-toggle-container">
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
      <span class="light-icon">‚òÄÔ∏è</span>
      <span class="dark-icon">üåô</span>
    </button>
  </div>
  
  <!-- Include navigation -->
  <nav class="main-navigation">
    <a href="../../home.html" class="site-logo">
      <img src="../../images/my-logo.svg" alt="English in Doses" width="150" height="auto">
    </a>
    <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
    <div class="nav-links">
      <a href="../../home.html" class="nav-link">Home</a>
      <a href="../../about.html" class="nav-link">About Us</a>
      <a href="../../contact.html" class="nav-link">Contact Us</a>
      <a href="../../home.html#where-to-start" class="nav-link">Grammar</a>
      <a href="../../extra-practice.html" class="nav-link">Extra Practice</a>     
      <a href="../../conversation-page.html" class="nav-link">Conversation</a>
      <a href="../../my-progress.html" class="nav-link">My Progress</a>
    </div>

    <div class="advanced-nav-indicator"></div>
    
  </nav>

  <div class="container">
    <!-- Include breadcrumbs -->
    <div class="breadcrumbs" aria-label="breadcrumb">
      <span class="breadcrumb-item"><a href="../../home.html">Home</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item"><a href="../advanced/advanced-grammar.html">Advanced Grammar</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item"><a href="advanced-grammar.html#advanced-tenses-and-aspect">Advanced Tenses</a></span>
      <span class="breadcrumb-separator">‚Ä∫</span>
      <span class="breadcrumb-item">Past Perfect Progressive vs. Past Perfect</span>
    </div>

    <main id="main-content">
      <h1>Past Perfect Progressive vs. Past Perfect</h1>

      <!-- INTRODUCTION SECTION -->
      <section class="intro-section">
        <h2>Introduction</h2>
        <p>Both the Past Perfect Progressive and Past Perfect tenses are used to talk about actions that happened before another time in the past. However, they focus on different aspects of these actions. Understanding the difference between these tenses will help you express past events more precisely in both writing and speaking.</p>
        
        <h3>After this lesson, you will be able to:</h3>
        <ul>
          <li>Form and use both the Past Perfect Progressive and Past Perfect correctly</li>
          <li>Understand when to choose one tense over the other</li>
          <li>Identify the subtle differences in meaning between these two tenses</li>
        </ul>
      </section>

      <!-- GRAMMAR POINT SECTION 1 -->
      <section class="grammar-point">
        <h2>Past Perfect: Form and Basic Use</h2>
        
        <p><strong>Form</strong>: Subject + had + past participle</p>
        
        <div class="example">
          <ol>
            <li>She <strong>had finished</strong> her report before the meeting started.</li>
            <li>We <strong>had visited</strong> Rome three times before we moved there.</li>
            <li>By the time he arrived, the train <strong>had left</strong>.</li>
          </ol>
        </div>
        
        <p><strong>When to use it</strong>: The Past Perfect emphasizes the <em>completion</em> of an action before another time in the past. We use it when:</p>
        
        <ul>
          <li>The result or completion of the action was important</li>
          <li>We want to highlight that something was finished before another past event</li>
          <li>We're talking about an experience that was completed before a past time</li>
        </ul>
        
        <div class="note">
          <p><strong>Native speaker note:</strong> In casual conversation, native speakers sometimes use simple past instead of past perfect, especially when the sequence of events is clear from context. However, in professional or academic writing, using past perfect correctly is important.</p>
        </div>
      </section>

      <!-- GRAMMAR POINT SECTION 2 -->
      <section class="grammar-point">
        <h2>Past Perfect Progressive: Form and Basic Use</h2>
        
        <p><strong>Form</strong>: Subject + had been + verb-ing</p>
        
        <div class="example">
          <ol>
            <li>She <strong>had been working</strong> on the project for six months before she was promoted.</li>
            <li>We <strong>had been waiting</strong> for the bus for 20 minutes when it finally arrived.</li>
            <li>His eyes were red because he <strong>had been crying</strong>.</li>
          </ol>
        </div>
        
        <p><strong>When to use it</strong>: The Past Perfect Progressive emphasizes the <em>duration</em> or <em>ongoing nature</em> of an action before another time in the past. We use it when:</p>
        
        <ul>
          <li>We want to focus on how long an activity continued up to a past moment</li>
          <li>We're explaining the cause of something in the past (especially with physical states or visible results)</li>
          <li>We want to emphasize the ongoing activity rather than its completion</li>
        </ul>
        
        <div class="note">
          <p><strong>Native speaker note:</strong> This tense often appears with time expressions like "for two hours," "since morning," or "all day" to emphasize the duration of the action.</p>
        </div>
      </section>

      <!-- GRAMMAR POINT SECTION 3 -->
      <section class="grammar-point">
        <h2>Key Differences and Choosing Between the Two Tenses</h2>
        
        <p><strong>Focus on completion vs. process</strong>:</p>
        
        <div class="example">
          <p>Past Perfect: <em>When we arrived, she <strong>had prepared</strong> dinner.</em> (The preparation was complete)</p>
          <p>Past Perfect Progressive: <em>When we arrived, she <strong>had been preparing</strong> dinner.</em> (She was in the process of preparing dinner)</p>
        </div>
        
        <p><strong>Emphasis on duration vs. result</strong>:</p>
        
        <div class="example">
          <p>Past Perfect Progressive: <em>I <strong>had been studying</strong> Spanish for five years before I moved to Madrid.</em> (Emphasizes the duration)</p>
          <p>Past Perfect: <em>I <strong>had studied</strong> Spanish before I moved to Madrid.</em> (Emphasizes the completed action/result)</p>
        </div>
        
        <p><strong>Explaining visible results or conditions</strong>:</p>
        
        <div class="example">
          <p>Past Perfect Progressive: <em>The ground was wet because it <strong>had been raining</strong>.</em> (Explains the visible result)</p>
          <p>Past Perfect: <em>It <strong>had rained</strong> earlier that day before we went out.</em> (Simply states a completed action)</p>
        </div>
        
        <div class="note">
          <p><strong>Native speaker note:</strong> When explaining why something looked a certain way in the past, native speakers often prefer the Past Perfect Progressive: "He was exhausted because he had been working all night."</p>
        </div>
      </section>

      <!-- VISUAL COMPARISON TABLE -->
      <section>
        <h2>Comparison of Past Perfect vs. Past Perfect Progressive</h2>
        <table>
          <thead>
            <tr>
              <th style="background-color: var(--header-bg);">Feature</th>
              <th style="background-color: var(--accent-color);">Past Perfect</th>
              <th style="background-color: var(--secondary-accent);">Past Perfect Progressive</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Form</strong></td>
              <td style="background-color: rgba(52, 152, 219, 0.1);">had + past participle</td>
              <td style="background-color: rgba(240, 125, 62, 0.1);">had been + verb-ing</td>
            </tr>
            <tr>
              <td><strong>Focus</strong></td>
              <td style="background-color: rgba(52, 152, 219, 0.1);">Completion of action</td>
              <td style="background-color: rgba(240, 125, 62, 0.1);">Duration or process</td>
            </tr>
            <tr>
              <td><strong>Common time markers</strong></td>
              <td style="background-color: rgba(52, 152, 219, 0.1);">before, by the time, already, just</td>
              <td style="background-color: rgba(240, 125, 62, 0.1);">for, since, all day/week, how long</td>
            </tr>
            <tr>
              <td><strong>Best for expressing</strong></td>
              <td style="background-color: rgba(52, 152, 219, 0.1);">Results, completed experiences</td>
              <td style="background-color: rgba(240, 125, 62, 0.1);">Ongoing activities, causes of conditions</td>
            </tr>
            <tr>
              <td><strong>When to use</strong></td>
              <td style="background-color: rgba(52, 152, 219, 0.1);">For completed actions or experiences before a past moment</td>
              <td style="background-color: rgba(240, 125, 62, 0.1);">To explain why something was a certain way in the past</td>
            </tr>
            <tr>
              <td><strong>Example</strong></td>
              <td style="background-color: rgba(52, 152, 219, 0.1);">I <strong>had finished</strong> the report.</td>
              <td style="background-color: rgba(240, 125, 62, 0.1);">I <strong>had been working</strong> on the report.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- REAL-LIFE CONTEXTS SECTION -->
      <section class="grammar-point">
        <h2>Real-Life Contexts and Examples</h2>
        
        <p><strong>1. Work Situations:</strong></p>
        
        <div class="example">
          <p>Past Perfect: <em>By the time the client arrived, we <strong>had prepared</strong> all the documents.</em> (The preparation was complete)</p>
          <p>Past Perfect Progressive: <em>We <strong>had been developing</strong> the new software for six months when the company decided to change direction.</em> (Emphasizes the ongoing process)</p>
        </div>
        
        <p><strong>2. Travel Experiences:</strong></p>
        
        <div class="example">
          <p>Past Perfect: <em>We <strong>had visited</strong> Paris twice before our recent trip.</em> (Completed experiences)</p>
          <p>Past Perfect Progressive: <em>We <strong>had been traveling</strong> around Europe for three months when our money ran out.</em> (Ongoing activity with duration)</p>
        </div>
        
        <p><strong>3. Daily Life Situations:</strong></p>
        
        <div class="example">
          <p>Past Perfect: <em>When we got home, the children <strong>had already done</strong> their homework.</em> (Completed action)</p>
          <p>Past Perfect Progressive: <em>The children were tired because they <strong>had been playing</strong> football all afternoon.</em> (Explains their condition)</p>
        </div>
      </section>

      <!-- COMMON ERRORS SECTION -->
      <section class="common-errors">
        <h2 class="common-errors-heading">Common Errors</h2>
        
        <div class="error-pattern">
          <p class="error-title"><strong>1: Using Past Perfect when Simple Past is sufficient</strong></p>
          <p class="incorrect">After she had left the office, she had gone to the supermarket.</p>
          <p class="correct">After she had left the office, she went to the supermarket. ‚úì</p>
          <p class="explanation"><em>When actions are in a clear sequence, use Past Perfect only for the earlier action. Use Simple Past for the later action.</em></p>
        </div>
        
        <div class="error-pattern">
          <p class="error-title"><strong>2: Confusing the form of Past Perfect Progressive</strong></p>
          <p class="incorrect">She had being working on the project for months.</p>
          <p class="correct">She had been working on the project for months. ‚úì</p>
          <p class="explanation"><em>Remember to use "had been" (not "had being") before the -ing form of the verb.</em></p>
        </div>
        
        <div class="error-pattern">
          <p class="error-title"><strong>3: Using Past Perfect Progressive with state verbs</strong></p>
          <p class="incorrect">He had been knowing the answer before the teacher explained it.</p>
          <p class="correct">He had known the answer before the teacher explained it. ‚úì</p>
          <p class="explanation"><em>State verbs like know, believe, have (possession), etc. usually use Past Perfect, not Past Perfect Progressive.</em></p>
        </div>
        
        <div class="error-pattern">
          <p class="error-title"><strong>4: Not including duration with Past Perfect Progressive</strong></p>
          <p class="incorrect">She had been waiting when the bus arrived.</p>
          <p class="correct">She had been waiting for 20 minutes when the bus arrived. ‚úì</p>
          <p class="explanation"><em>Past Perfect Progressive often includes a duration phrase (for/since + time period) to be most effective.</em></p>
        </div>
      </section>

      <!-- TIPS SECTION -->
      <section class="tips">
        <h2 class="tips-heading">How to Remember and Practice</h2>
        
        <div class="grammar-tip">
          <p>üìù <strong>Memory Tip:</strong> Think of Past Perfect as a "completion" tense (had + completed action) and Past Perfect Progressive as a "duration" tense (had been + ongoing action).</p>
        </div>
        
        <div class="grammar-tip">
          <p>üìù <strong>Practice Exercise 1:</strong>Practice with your daily life: Write about a day last week, using Past Perfect for completed tasks and Past Perfect Progressive for ongoing activities. "I woke up late because I had forgotten to set my alarm clock. By the time I got to the meeting, my client had been waiting for 20 minutes. He wasn't happy!"</p>
        </div>
        
        <div class="grammar-tip">
          <p>üìù <strong>Practice Exercise 2:</strong> Write your own story about a mysterious situation using Past Perfect Progressive to build suspense about ongoing actions and Past Perfect to reveal completed actions. For example: "When I entered the room, someone had been cooking (smell, mess), but they had already left (completed action)."</p>
        </div>
        
        <div class="grammar-tip">
          <p>üìù <strong>Practice Exercise 3:</strong> Make a list of state verbs (know, believe, want, etc.) and action verbs (work, run, study, etc.). Practice creating sentences with state verbs in Past Perfect and action verbs in both Past Perfect and Past Perfect Progressive to understand the difference in meaning.</p>
        </div>
      </section>

      <!-- MCQ PRACTICE SECTION -->
      <section class="content-section mcq-container">
        <h2>Test Your Knowledge</h2>
        <p class="mcq-instructions">Choose the correct option for each question. Questions progress from basic to more challenging levels.</p>
        
        <!-- Progress indicator -->
        <div class="mcq-progress">
          <div class="progress-container">
            <div id="mcq-progress-bar" class="progress-bar" style="width: 0%"></div>
          </div>
          <div class="progress-info">Question: <span id="current-question">1</span>/<span id="total-questions">10</span></div>
        </div>
        
        <div id="mcq-container" class="activity-container active">
          <div class="questions-container">
            <!-- Question 1 - Basic level -->
            <div id="q1" class="question" data-difficulty="basic">
              <p class="question-number">Question 1</p>
              <div class="question-context">
                <p class="mcq-question">Sarah was very tired because she _____ at the computer for eight hours.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q1-option0" name="q1" value="0">
                  <label for="q1-option0">worked</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q1-option1" name="q1" value="1">
                  <label for="q1-option1">had worked</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q1-option2" name="q1" value="2">
                  <label for="q1-option2">had been working</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q1-option3" name="q1" value="3">
                  <label for="q1-option3">has been working</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 2 - Basic level -->
            <div id="q2" class="question" data-difficulty="basic">
              <p class="question-number">Question 2</p>
              <div class="question-context">
                <p class="mcq-question">By the time we arrived at the restaurant, our friends _____ their meal.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q2-option0" name="q2" value="0">
                  <label for="q2-option0">had finished</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q2-option1" name="q2" value="1">
                  <label for="q2-option1">had been finishing</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q2-option2" name="q2" value="2">
                  <label for="q2-option2">finished</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q2-option3" name="q2" value="3">
                  <label for="q2-option3">were finishing</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 3 - Basic level -->
            <div id="q3" class="question" data-difficulty="basic">
              <p class="question-number">Question 3</p>
              <div class="question-context">
                <p class="mcq-question">The ground was wet because it _____ all night.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q3-option0" name="q3" value="0">
                  <label for="q3-option0">had been raining</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q3-option1" name="q3" value="1">
                  <label for="q3-option1">had rained</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q3-option2" name="q3" value="2">
                  <label for="q3-option2">was raining</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q3-option3" name="q3" value="3">
                  <label for="q3-option3">rained</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 4 - Intermediate level -->
            <div id="q4" class="question" data-difficulty="intermediate">
              <p class="question-number">Question 4</p>
              <div class="question-context">
                <p class="mcq-question">He _____ in five different countries before he settled in Canada.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q4-option0" name="q4" value="0">
                  <label for="q4-option0">had been living</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q4-option1" name="q4" value="1">
                  <label for="q4-option1">had lived</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q4-option2" name="q4" value="2">
                  <label for="q4-option2">has lived</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q4-option3" name="q4" value="3">
                  <label for="q4-option3">lived</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 5 - Intermediate level -->
            <div id="q5" class="question" data-difficulty="intermediate">
              <p class="question-number">Question 5</p>
              <div class="question-context">
                <p class="mcq-question">When the power went out, I _____ on my computer for three hours without saving my work.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q5-option0" name="q5" value="0">
                  <label for="q5-option0">worked</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q5-option1" name="q5" value="1">
                  <label for="q5-option1">had worked</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q5-option2" name="q5" value="2">
                  <label for="q5-option2">had been working</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q5-option3" name="q5" value="3">
                  <label for="q5-option3">was working</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 6 - Intermediate level -->
            <div id="q6" class="question" data-difficulty="intermediate">
              <p class="question-number">Question 6</p>
              <div class="question-context">
                <p class="mcq-question">Peter _____ the company for two years when he got promoted to manager.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q6-option0" name="q6" value="0">
                  <label for="q6-option0">had joined</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q6-option1" name="q6" value="1">
                  <label for="q6-option1">had been joining</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q6-option2" name="q6" value="2">
                  <label for="q6-option2">joined</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q6-option3" name="q6" value="3">
                  <label for="q6-option3">had been working for</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 7 - Advanced level -->
            <div id="q7" class="question" data-difficulty="advanced">
              <p class="question-number">Question 7</p>
              <div class="question-context">
                <p class="mcq-question">By the time I arrived at the airport, the plane _____.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q7-option0" name="q7" value="0">
                  <label for="q7-option0">had been leaving</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q7-option1" name="q7" value="1">
                  <label for="q7-option1">had left</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q7-option2" name="q7" value="2">
                  <label for="q7-option2">left</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q7-option3" name="q7" value="3">
                  <label for="q7-option3">was leaving</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 8 - Advanced level -->
            <div id="q8" class="question" data-difficulty="advanced">
              <p class="question-number">Question 8</p>
              <div class="question-context">
                <p class="mcq-question">The hikers were exhausted because they _____ for seven hours without a break.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q8-option0" name="q8" value="0">
                  <label for="q8-option0">walked</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q8-option1" name="q8" value="1">
                  <label for="q8-option1">had walked</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q8-option2" name="q8" value="2">
                  <label for="q8-option2">had been walking</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q8-option3" name="q8" value="3">
                  <label for="q8-option3">were walking</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 9 - Advanced level -->
            <div id="q9" class="question" data-difficulty="advanced">
              <p class="question-number">Question 9</p>
              <div class="question-context">
                <p class="mcq-question">We _____ to book a table, so we couldn't get into the restaurant.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q9-option0" name="q9" value="0">
                  <label for="q9-option0">had forgotten</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q9-option1" name="q9" value="1">
                  <label for="q9-option1">had been forgetting</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q9-option2" name="q9" value="2">
                  <label for="q9-option2">forgot</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q9-option3" name="q9" value="3">
                  <label for="q9-option3">have forgotten</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
            
            <!-- Question 10 - Expert level -->
            <div id="q10" class="question" data-difficulty="expert">
              <p class="question-number">Question 10</p>
              <div class="question-context">
                <p class="mcq-question">When I saw Dave yesterday, he told me he _____ for a new job for several months.</p>
              </div>
              <div class="options">
                <div class="option" data-index="0">
                  <input type="radio" id="q10-option0" name="q10" value="0">
                  <label for="q10-option0">had been looking</label>
                </div>
                <div class="option" data-index="1">
                  <input type="radio" id="q10-option1" name="q10" value="1">
                  <label for="q10-option1">had looked</label>
                </div>
                <div class="option" data-index="2">
                  <input type="radio" id="q10-option2" name="q10" value="2">
                  <label for="q10-option2">has been looking</label>
                </div>
                <div class="option" data-index="3">
                  <input type="radio" id="q10-option3" name="q10" value="3">
                  <label for="q10-option3">looked</label>
                </div>
              </div>
              <div class="feedback" aria-live="polite"></div>
            </div>
          </div>
          
          <!-- Navigation buttons -->
          <div class="question-navigation">
            <button id="prev-question" class="nav-button" disabled>Previous</button>
            <button id="next-question" class="nav-button">Next</button>
          </div>
          
          <!-- Control buttons -->
          <div class="control-buttons">
            <button id="mcq-submit" class="submit-btn">Check Answers</button>
            <button id="mcq-restart" class="restart-btn" style="display:none;">Try Again</button>
            <a href="#grammar-summary" id="check-grammar" class="nav-button" style="display:none;">Review Grammar</a>
          </div>
          
          <!-- Results summary -->
          <div id="mcq-results" class="results-container" style="display:none;">
            <h3>Your Results</h3>
            <div class="score-display">
              <p>Your score: <span id="score-value">0</span>/<span id="total-questions-score">10</span></p>
              <div class="progress-container">
                <div id="results-progress-bar" class="progress-bar" style="width: 0%"></div>
              </div>
            </div>
            <div class="difficulty-breakdown">
              <div class="difficulty-section">
                <h4>Basic (Questions 1-3)</h4>
                <p><span id="basic-score">0</span>/3 correct</p>
              </div>
              <div class="difficulty-section">
                <h4>Intermediate (Questions 4-6)</h4>
                <p><span id="intermediate-score">0</span>/3 correct</p>
              </div>
              <div class="difficulty-section">
                <h4>Advanced (Questions 7-9)</h4>
                <p><span id="advanced-score">0</span>/3 correct</p>
              </div>
              <div class="difficulty-section">
                <h4>Expert (Question 10)</h4>
                <p><span id="expert-score">0</span>/1 correct</p>
              </div>
            </div>
            <div class="feedback-summary">
              <p>Review your answers above to see explanations for each question.</p>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Grammar summary section (target for "Check the Grammar" button) -->
      <section id="grammar-summary" class="grammar-summary">
        <h2>Key Points to Remember</h2>
        <ul>
          <li><strong>Past Perfect</strong> (had + past participle): Used to indicate completed actions before another past time or event.</li>
          <li><strong>Past Perfect Progressive</strong> (had been + verb-ing): Used to emphasize duration and ongoing actions before another past time.</li>
          <li>Use Past Perfect when focusing on the completion or result.</li>
          <li>Use Past Perfect Progressive when explaining causes, especially with visible results (e.g., "He was tired because he had been working all night.").</li>
          <li>Past Perfect Progressive often uses time expressions like "for," "since," "all day/week."</li>
          <li>Use Past Perfect with state verbs (know, believe, etc.), not Past Perfect Progressive.</li>
        </ul>
      </section>
    </main>
  </div>
  
  <!-- BOTTOM NAVIGATION -->
  <nav class="bottom-navigation">
    <a href="present-perfect-progressive.html" class="nav-button previous">‚Üê Previous: Present Perfect Progressive</a>
    <div class="center-buttons">
      <button class="nav-button print-button" onclick="window.print()">Print This Page</button>
      <a href="past-perfect-practice.html" class="nav-button activities">Practice Activities</a>
    </div>
    <a href="future-perfect.html" class="nav-button next">Next: Future Perfect Tenses ‚Üí</a>
  </nav>

  <!-- Include footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="../../home.html">Home</a></li>
          <li><a href="../../home.html#where-to-start">Grammar</a></li>
          <li><a href="../../extra-practice.html">Extra Practice</a></li>
          <li><a href="../../my-progress.html">My Progress</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Grammar Topics</h3>
        <ul>
          <li><a href="advanced-grammar.html#advanced-tenses-and-aspect">Advanced Tenses</a></li>
          <li><a href="advanced-grammar.html#conditionals">Advanced Conditionals</a></li>
          <li><a href="advanced-grammar.html#modals">Advanced Modal Verbs</a></li>
          <li><a href="advanced-grammar.html#passive">Advanced Passive Voice</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Connect</h3>
        <ul>
          <li><a href="../../about.html">About</a></li>
          <li><a href="../../contact.html">Contact</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>¬© 2025 English in Doses | All rights reserved | <a href="../../license.html">Licensing Information</a></p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="../../js/core.js"></script>
  <script src="../../js/mcq.js"></script>
  <script src="../../js/progress-tracking.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize MCQ Module with new MCQ system
      const totalQuestions = document.querySelectorAll('#mcq-container .question').length;
      document.getElementById('total-questions').textContent = totalQuestions;
      document.getElementById('total-questions-score').textContent = totalQuestions;
      
      // Show only the first question initially
      showQuestion(1);
      
      // Set up navigation
      document.getElementById('next-question').addEventListener('click', function() {
        const currentQuestionNum = parseInt(document.getElementById('current-question').textContent);
        if (currentQuestionNum < totalQuestions) {
          showQuestion(currentQuestionNum + 1);
        }
      });
      
      document.getElementById('prev-question').addEventListener('click', function() {
        const currentQuestionNum = parseInt(document.getElementById('current-question').textContent);
        if (currentQuestionNum > 1) {
          showQuestion(currentQuestionNum - 1);
        }
      });
      
      // Check Answers
      document.getElementById('mcq-submit').addEventListener('click', function() {
        // Hide navigation buttons
        document.getElementById('next-question').style.display = 'none';
        document.getElementById('prev-question').style.display = 'none';
        
        // Show all questions for review
        document.querySelectorAll('#mcq-container .question').forEach(question => {
          question.style.display = 'block';
        });
        
        // Calculate scores
        const answers = {
          'q1': 2,  // had been working
          'q2': 0,  // had finished
          'q3': 0,  // had been raining
          'q4': 1,  // had lived
          'q5': 2,  // had been working
          'q6': 3,  // had been working for
          'q7': 1,  // had left
          'q8': 2,  // had been walking
          'q9': 0,  // had forgotten
          'q10': 0  // had been looking
        };
        
        const explanations = {
          "q1": "The Past Perfect Progressive is correct here because we need to explain why Sarah was tired (a visible result) and emphasize the duration of her work (eight hours).",
          "q2": "The Past Perfect is correct here because the action (finishing the meal) was completed before another past event (our arrival).",
          "q3": "The Past Perfect Progressive is correct here because we're explaining a visible condition (wet ground) and emphasizing the ongoing nature of the rain.",
          "q4": "The Past Perfect is correct here because we're talking about completed experiences in different countries before settling in Canada.",
          "q5": "The Past Perfect Progressive is correct here because we're emphasizing the ongoing activity (working) and its duration (three hours) before the power went out.",
          "q6": "The Past Perfect Progressive with 'working for' is correct here because we're emphasizing the duration of time (two years) at the company.",
          "q7": "The Past Perfect is correct here because the plane's departure was a completed action before another past event (my arrival).",
          "q8": "The Past Perfect Progressive is correct here because we're explaining why the hikers were exhausted (a result) and emphasizing the duration (seven hours).",
          "q9": "The Past Perfect is correct here because the forgetting was a completed action that happened before another past event (not getting into the restaurant).",
          "q10": "The Past Perfect Progressive is correct here because we're emphasizing the ongoing nature and duration (several months) of the job search before the conversation."
        };
        
        let totalScore = 0;
        let basicScore = 0;
        let intermediateScore = 0;
        let advancedScore = 0;
        let expertScore = 0;
        
        // Check each question
        Object.keys(answers).forEach(questionId => {
          const question = document.getElementById(questionId);
          const selectedOption = question.querySelector('input[type="radio"]:checked');
          const feedback = question.querySelector('.feedback');
          
          if (selectedOption) {
            const selectedIndex = parseInt(selectedOption.value);
            const correctIndex = answers[questionId];
            
            if (selectedIndex === correctIndex) {
              feedback.innerHTML = `<p class="correct-feedback">‚úì Correct! ${explanations[questionId]}</p>`;
              totalScore++;
              
              // Update difficulty scores
              const difficulty = question.getAttribute('data-difficulty');
              if (difficulty === 'basic') basicScore++;
              if (difficulty === 'intermediate') intermediateScore++;
              if (difficulty === 'advanced') advancedScore++;
              if (difficulty === 'expert') expertScore++;
            } else {
              const correctOptionLabel = question.querySelector(`label[for="${questionId}-option${correctIndex}"]`).textContent;
              feedback.innerHTML = `<p class="incorrect-feedback">‚úó Incorrect. The correct answer is: ${correctOptionLabel}</p><p>${explanations[questionId]}</p>`;
            }
          } else {
            feedback.innerHTML = '<p class="incorrect-feedback">No answer selected.</p>';
          }
        });
        
        // Update score display
        document.getElementById('score-value').textContent = totalScore;
        document.getElementById('basic-score').textContent = basicScore;
        document.getElementById('intermediate-score').textContent = intermediateScore;
        document.getElementById('advanced-score').textContent = advancedScore;
        document.getElementById('expert-score').textContent = expertScore;
        
        // Update progress bar
        const percentage = (totalScore / totalQuestions) * 100;
        document.getElementById('results-progress-bar').style.width = percentage + '%';
        
        // Show results
        document.getElementById('mcq-results').style.display = 'block';
        document.getElementById('mcq-submit').style.display = 'none';
        document.getElementById('mcq-restart').style.display = 'inline-block';
        document.getElementById('check-grammar').style.display = 'inline-block';
        
        // Track progress
        if (typeof ProgressTrackingModule !== 'undefined') {
          ProgressTrackingModule.markItemCompleted('activities', 'mcq-past-perfect-progressive-vs-past-perfect', {
            score: totalScore,
            maxScore: totalQuestions,
            completed: true,
            completedAt: new Date().toISOString(),
            title: 'Past Perfect Progressive vs. Past Perfect Quick Practice'
          });
          
          // Also mark the lesson as viewed/completed
          ProgressTrackingModule.updateItemProgress('lessons', 'past-perfect-progressive', {
            lastViewed: new Date().toISOString(),
            progress: 100, // Percent complete
            title: 'Past Perfect Progressive vs. Past Perfect'
          });
        }
      });
      
      // Restart Quiz
      document.getElementById('mcq-restart').addEventListener('click', function() {
        // Reset all selections and feedback
        document.querySelectorAll('#mcq-container input[type="radio"]').forEach(radio => {
          radio.checked = false;
        });
        
        document.querySelectorAll('#mcq-container .feedback').forEach(feedback => {
          feedback.innerHTML = '';
        });
        
        // Show only first question again
        showQuestion(1);
        
        // Reset UI
        document.getElementById('next-question').style.display = 'inline-block';
        document.getElementById('prev-question').style.display = 'inline-block';
        document.getElementById('mcq-results').style.display = 'none';
        document.getElementById('mcq-submit').style.display = 'inline-block';
        document.getElementById('mcq-restart').style.display = 'none';
        document.getElementById('check-grammar').style.display = 'none';
      });
      
      // Helper function to show a specific question
      function showQuestion(questionNumber) {
        // Hide all questions
        document.querySelectorAll('#mcq-container .question').forEach(question => {
          question.style.display = 'none';
        });
        
        // Show the selected question
        const questions = document.querySelectorAll('#mcq-container .question');
        if (questionNumber > 0 && questionNumber <= questions.length) {
          questions[questionNumber - 1].style.display = 'block';
        }
        
        // Update current question display
        document.getElementById('current-question').textContent = questionNumber;
        
        // Update progress bar
        const percentage = ((questionNumber - 1) / (questions.length - 1)) * 100;
        document.getElementById('mcq-progress-bar').style.width = percentage + '%';
        
        // Enable/disable navigation buttons
        document.getElementById('prev-question').disabled = (questionNumber === 1);
        document.getElementById('next-question').disabled = (questionNumber === questions.length);
      }
    });
  </script>
</body>
</html>